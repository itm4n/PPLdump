#pragma once

#include "ntdll.h"

#include <Windows.h>
#include <strsafe.h>
#include <Lmcons.h>
#include <tlhelp32.h>
#include <shlwapi.h>
#include <aclapi.h>
#include <shellapi.h>
#include <DbgHelp.h>
#include <comdef.h>

#pragma comment(lib, "Shlwapi.lib")
#pragma comment(lib, "Advapi32.lib")
#pragma comment(lib, "Shell32.lib")
#pragma comment(lib, "Dbghelp.lib")

extern HMODULE g_hInstance;
extern HANDLE g_hConsoleOutput;
extern DWORD g_dwProcessId;
extern LPWSTR g_pwszDumpFilePath;
extern LPWSTR g_pwszGuid;
extern BOOL g_bVerbose;
extern BOOL g_bDebug;

void DoStuff();
void LogToConsole(LPCWSTR pwszFormat, ...);
void LogLastError(LPCWSTR pwszFunctionName);
BOOL GetCurrentDllFileName(LPWSTR* ppwszDllName);
BOOL DeleteKnownDllEntry(LPCWSTR pwszDllName);
BOOL ParseCommandLine();
BOOL DumpProcessMemory(DWORD dwProcessId, LPWSTR pwszDumpFilePath);
